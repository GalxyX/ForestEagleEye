<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>森林问答</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.1/normalize.min.css">
    <link rel="stylesheet" href="../static/css/large_model.css">
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <style>
        .conversation {
            margin-top: 20px;
            max-height: 500px;
            overflow-y: auto;
            background-color: #f9f9f9;
            padding: 15px;
            border-radius: 5px;
        }
        .q-a {
            margin-bottom: 15px;
            padding: 10px;
            background-color: #fff;
            border-radius: 5px;
            box-shadow: 0 0 5px rgba(0,0,0,0.1);
        }
        .q-a .question {
            font-weight: bold;
            color: #2c3e50;
        }
        .q-a .answer {
            margin-top: 5px;
            color: #34495e;
        }
        .loading {
            display: none;
            margin-top: 10px;
            color: #ff4500;
        }
    </style>
</head>
<body>
    <header class="header">
        <h1>欢迎来到森林问答</h1>
    </header>

    <div class="container">
        <div class="main-content">
            <form id="question-form">
                <input type="text" id="question" placeholder="输入你的问题" required>
                <button type="submit">提交</button>
            </form>
            <div id="loading" class="loading">加载中...</div>
            <div id="conversation" class="conversation">
            </div>
        </div>
    </div>

    <script>
        $(document).ready(function() {
            $('#question-form').on('submit', function(event) {
                event.preventDefault();
                var question = $('#question').val().trim();
                if (question === "") {
                    alert("请输入一个有效的问题！");
                    return;
                }
                $('#loading').show();
                $('#question').val('');
                $.post('/ask_model', {question: question}, function(data) {
                    $('#loading').hide();
                    if(data.text && typeof data.text === 'object' && data.text.text){
                        var qaDiv = $('<div class="q-a"></div>');
                        var questionP = $('<p class="question"></p>').text("Q: " + question);
                        var answerP = $('<p class="answer"></p>').text("A: " + data.text.text);
                        qaDiv.append(questionP);
                        qaDiv.append(answerP);
                        $('#conversation').prepend(qaDiv);
                    } else if(data.text && typeof data.text === 'string'){
                        var qaDiv = $('<div class="q-a"></div>');
                        var questionP = $('<p class="question"></p>').text("Q: " + question);
                        var answerP = $('<p class="answer"></p>').text("A: " + data.text);
                        qaDiv.append(questionP);
                        qaDiv.append(answerP);
                        $('#conversation').prepend(qaDiv);
                    } else {
                        alert("获取回答失败，请稍后再试。");
                    }
                }).fail(function() {
                    $('#loading').hide();
                    alert("服务器错误，请稍后再试。");
                });
            });

            $("#head a").on("click", function () {
                var position = $(this).position();
                var width = $(this).outerWidth();
                $("#head .slide1").css({ opacity: 1, left: position.left, width: width });
            });
            $("#head a").on("mouseover", function () {
                var position = $(this).position();
                var width = $(this).outerWidth();
                $("#head .slide1").css({ opacity: 1, left: position.left, width: width });
                $("#head .slide2").css({ opacity: 1, left: position.left, width: width, height: '80%' }).addClass("squeeze");
                $(this).css("color", "#ff4500");
            });
            $("#head a").on("mouseout", function () {
                $("#head .slide1").css({ opacity: 0 });
                $("#head .slide2").css({ opacity: 0 }).removeClass("squeeze");
                $(this).css("color", "#fff");
            });
        });
    </script>
</body>
</html>
